<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chomp API Test Runner - Refactored</title>
  <link rel="stylesheet" href="/api-test-runner.css">
</head>
<body>
  <div class="container">
    <h1>Chomp API Test Runner - Refactored</h1>
    <p>Test all API endpoints with real data (via Test Runner Server on port 8080)</p>

    <div class="tabs">
      <button class="tab active" data-tab="tests">API Tests</button>
      <button class="tab" data-tab="schema">Database Schema</button>
      <button class="tab" data-tab="data">Database Data</button>
    </div>

    <div class="tab-content" id="tests">
      <div class="server-status">
        <div class="status">
          <h3>Test Runner Server (Backend Proxy)</h3>
          <p>Status: <span id="backend-status">Unknown</span></p>
        </div>
        <div class="status">
          <h3>Backend Server</h3>
          <p>Status: <span id="frontend-status">Unknown</span></p>
        </div>
      </div>

      <div class="tab-content" id="tests-content">
        <div class="button-container">
          <button id="connect-reset">Connect & Reset</button>
          <button id="superuser-login" class="primary-button">Login as Superuser</button>
          <button id="run-all-tests" disabled>Run All Tests</button>
          <button id="clear-log">Clear Log</button>
        </div>
        
        <div id="superuser-status" class="superuser-status">
          <span class="status-label">Superuser Status:</span>
          <span id="superuser-status-value" class="status-value status-not-authenticated">Not Authenticated</span>
        </div>

        <h3>Available Tests</h3>
        <div id="test-list" class="test-list">
          <!-- Individual tests will be added here by JavaScript -->
        </div>

        <!-- E2E Testing Endpoints section removed - using only real, live API endpoints -->
        <div class="category">
          <h3>Core Service Layer Tests</h3>
          <div class="category-tests" data-category="service-core"></div>
        </div>
        <div class="category">
          <h3>Additional Service Tests</h3>
          <div class="category-tests" data-category="service-additional"></div>
        </div>
      </div>

      <div class="results-panel">
        <div class="results-header">
          <h2>Test Results</h2>
          <div class="results-controls">
            <button id="expand-all">Expand All</button>
            <button id="collapse-all">Collapse All</button>
          </div>
        </div>
        <div id="test-log"></div>
      </div>

      <h2>Test Summary</h2>
      <div id="test-summary">
        <div id="summary-content">Connect to servers and run tests to see results.</div>
        <div class="summary-controls">
          <button id="copy-results">Copy All Results</button>
        </div>
      </div>
      <div id="test-results" class="test-results-container"></div>
    </div>

    <div class="tab-content" id="schema" style="display: none;">
      <div class="schema-controls">
        <button id="load-schema">Load Database Schema</button>
        <button id="refresh-schema">Refresh Schema</button>
      </div>

      <div id="schema-content">
        Loading database schema...
      </div>

      <div id="schema-error" style="display: none;">
        Error loading database schema. Please check server connection.
      </div>
    </div>

    <div class="tab-content" id="data" style="display: none;">
      <div class="data-controls">
        <button id="load-data">Load Database Data</button>
        <button id="refresh-data">Refresh Data</button>
      </div>

      <div class="table-selector">
        <label for="table-select">Select Table:</label>
        <select id="table-select">
          <option value="">-- Select a table --</option>
        </select>
      </div>

      <div id="data-content">
        Select a table to view its data.
      </div>

      <div id="data-error" style="display: none;">
        Error loading database data. Please check server connection.
      </div>
    </div>

    <!-- Load scripts as regular scripts to avoid module loading issues -->
    <script src="app-bundle.js"></script>
  </div>
</body>
</html>